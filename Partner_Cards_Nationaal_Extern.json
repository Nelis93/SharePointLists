// 1. Open in de list view de drop down menu 'Alle items'
// 2. Selecteer 'Nieuwe weergave maken'
// 3. Geef de weergave een naam (Partners_(Inter)nationaal_Intern/Extern), selecteer 'Gallerie' en klik op 'Maken'
// 4. Klik op dezelfde plek op de naam van de nieuwe weergave.
// 5. Selecteer 'Huidige weergave opmaken'
// 6. Klik op 'Kaartontwerper' (niet op 'Kaart bewerken')
// 7. Selecteer onderaan 'Geavanceerde modus'
// 8. Kopieer de code uit het bestand (Partner_Cards_Code.txt)in de documenten van de template
// 9. Verwijder alle bestaande code en vervang deze door de code uit het text-bestand.
// 10. Alternatief: Pas de code aan de hand van de onderstaande richtlijnen aan (customizing)

{
    "$schema": "https://developer.microsoft.com/json-schemas/sp/v2/tile-formatting.schema.json",

// de hoogte en breedte van de cards dient gestandardiseerd te worden    
    
    "height": "550",
    "width": "350",
    "hideSelection": false,
    "fillHorizontally": true,
    "formatter": {
      "elmType": "div",
      "attributes": {
        "class": "sp-card-container"
      },
      "children": [

// Het eerste 'child' is verwijderd. Dit is een 'button' element dat niet gewenst is. 
// Het gaat om lijn 13 t.e.m 22 in het origineel 

        {
          "elmType": "div",
          "attributes": {
            "class": "ms-bgColor-white sp-css-borderColor-neutralLight sp-card-borderHighlight sp-card-subContainer"
          },
          "children": [
            {
              "elmType": "div",
              "attributes": {
                "class": "sp-card-previewColumnContainer"
              },
              "children": [
                {
                  "elmType": "div",
                  "attributes": {
                    "class": "sp-card-imageContainer"
                  },
                  "children": [
                    {
                      "elmType": "div",
                      "attributes": {
                        "class": "ms-bgColor-neutralLight sp-card-imagePreviewBackground"
                      },

// Voeg de volgende 6 lijnen code in zodat het logo mooi in zijn plaats valt.

                      "style": {
                        "background-color": "white",
                        "display": "flex",
                        "justify-content": "center",
                        "align-items": "center"
                      },
                      "children": [
                        {
                          "elmType": "img",
                          "style": {
                            "display": "=if([$Logo] == '', 'none', '')",

// Beperk de grootte van het logo zodat het de card niet vervormt.
// Plaats een komma achter de voorgaande lijn
// Voeg de volgende twee lijnen code toe

                            "max-width": "50%",
                            "max-height": "50%"
                          },
                          "attributes": {
                            "src": "=getThumbnailImage([$Logo], 400, 400)",
                            "title": "[$Logo.fileName]",
                            "class": "sp-card-imagePreview"
                          }
                        },
                        {
                          "elmType": "svg",
                          "style": {
                            "display": "=if([$Logo] == '', '', 'none')"
                          },
                          "attributes": {
                            "preserveAspectRatio": "none",
                            "viewBox": "0 0 210 105",
                            "class": "sp-card-defaultImage ms-bgColor-themeLighter"
                          },
                          "children": [
                            {
                              "elmType": "path",
                              "attributes": {
                                "id": "sp-card-defaultImage-path1",
                                "d": "M0 25.7896L126.5 53.8817L96 105H0V25.7896Z"
                              }
                            },
                            {
                              "elmType": "path",
                              "attributes": {
                                "id": "sp-card-defaultImage-path2",
                                "d": "M96 105L158.7 0H204C207.314 0 210 2.68629 210 6V105H96Z"
                              }
                            }
                          ]
                        },
                        {
                          "elmType": "svg",
                          "style": {
                            "display": "=if([$Logo] == '', '', 'none')"
                          },
                          "attributes": {
                            "class": "sp-card-defaultImageOverlay",
                            "viewBox": "0 0 40 40"
                          },
                          "children": [
                            {
                              "elmType": "path",
                              "attributes": {
                                "id": "sp-card-defaultImageOverlay-path1",
                                "d": "M 4 4 H 37 V 37 H 4 L 4 4"
                              }
                            },
                            {
                              "elmType": "path",
                              "attributes": {
                                "id": "sp-card-defaultImageOverlay-path2",
                                "d": "M24.17 21.151L21.66 24.741L17.54 19.191C17.3322 18.914 17.0062 18.751 16.66 18.751C16.3137 18.751 15.9877 18.914 15.78 19.191L9.20997 28.051C8.97126 28.3786 8.93818 28.813 9.12453 29.173C9.31088 29.533 9.68465 29.7567 10.09 29.751H29.91C30.3085 29.7562 30.6769 29.5396 30.866 29.1887C31.0551 28.8378 31.0335 28.411 30.81 28.081L26 21.151C25.7991 20.8407 25.4546 20.6533 25.085 20.6533C24.7153 20.6533 24.3709 20.8407 24.17 21.151Z"
                              }
                            },
                            {
                              "elmType": "path",
                              "attributes": {
                                "id": "sp-card-defaultImageOverlay-path3",
                                "d": "M28 15.751C29.3807 15.751 30.5 14.6317 30.5 13.251C30.5 11.8703 29.3807 10.751 28 10.751C26.6193 10.751 25.5 11.8703 25.5 13.251C25.5 14.6317 26.6193 15.751 28 15.751Z"
                              }
                            },
                            {
                              "elmType": "path",
                              "attributes": {
                                "id": "sp-card-defaultImageOverlay-path4",
                                "d": "M4.5 37.251H35.5C36.3284 37.251 37 36.5794 37 35.751V4.75098C37 3.92255 36.3284 3.25098 35.5 3.25098H4.5C3.67157 3.25098 3 3.92255 3 4.75098V35.751C3 36.5794 3.67157 37.251 4.5 37.251ZM4 4.75098C4 4.47483 4.22386 4.25098 4.5 4.25098H35.5C35.7761 4.25098 36 4.47483 36 4.75098V35.751C36 36.0271 35.7761 36.251 35.5 36.251H4.5C4.22386 36.251 4 36.0271 4 35.751V4.75098Z"
                              }
                            }
                          ]
                        }
                      ]
                    }
                  ]
                }
              ]
            },
            {
              "elmType": "div",
              "attributes": {
                "class": "sp-card-displayColumnContainer"
              },
              "children": [
                {
                  "elmType": "p",
                  "attributes": {
                    "class": "ms-fontColor-neutralSecondary sp-card-label"
                  },
                  "txtContent": "[!Title.DisplayName]",

// we willen de het woord 'titel' niet tonen boven de titel, dus geen 'display'
// voeg achter de laatse lijn een komma toe en daaronder de volgende drie lijnen code

                  "style": {
                    "display": "none"
                  }
                },
                {
                  "elmType": "p",
                  "attributes": {
                    "title": "[$Title]",
                    "class": "ms-fontColor-neutralPrimary sp-card-content sp-card-highlightedContent",
                    "role": "heading",
                    "aria-level": "3"
                  },
    
// Tussen de tweede set aanhalingstekens staat in de originele code een koppelteken
// Dit mag verwijderd worden. Als het veld voor de kolom 'titel' voor dit item niet ingevuld werd,
// willen we niet dat hier een koppelteken voor in de plaats gezet word. Let wel, titel is altijd een verplicht veld.

                  "txtContent": "=if ([$Title] == '', '', [$Title])",

// Hieronder voegen we een opmaak toe zodat de titel mooi in het midden komt te staan en een bepaalde lettergrootte heeft
// Voeg de volgende vier lijnen code in, en een komma na de voorgaande lijn

                  "style": {
                    "text-align": "center",
                    "font-size": "1.2em"
                  }
                }
              ]
            },
            {
              "elmType": "div",
              "attributes": {
                "class": "sp-card-displayColumnContainer"
              },
              "children": [
                {
                  "elmType": "p",
                  "attributes": {
                    "class": "ms-fontColor-neutralSecondary sp-card-label"
                  },
                  "txtContent": "[!Locatie_NL.DisplayName]",

// Voeg de komma in achter de voorgaande lijn en hierna de volgende drie lijnen code

                  "style": {
                    "display": "none"
                  }
                },
                {
                  "elmType": "p",
                  "attributes": {
                    "title": "[$Locatie_NL.DisplayName]",
                    "class": "ms-fontColor-neutralPrimary sp-card-content "
                  },

// Verwijder opnieuw het koppelteken tussen de tweede set aanhalingstekens en voeg de vier lijnen opmaak toe (+ komma)

                  "txtContent": "=if ([$Locatie_NL] == '', '', [$Locatie_NL.DisplayName])",
                  "style": {
                    "text-align": "center",
                    "font-style": "italic"
                  }
                }
              ]
            },
            {
              "elmType": "div",
              "attributes": {
                "class": "sp-card-displayColumnContainer"
              },
              "children": [
                {
                  "elmType": "p",
                  "attributes": {
                    "class": "ms-fontColor-neutralSecondary sp-card-label"
                  },
                  "txtContent": "[!Betrokkenheid_NL.DisplayName]",

// Plaats de komma achter de voorgaande lijn en voeg de volgende drie lijnen code in

                  "style": {
                    "display": "none"
                  }
                },
                {
                  "elmType": "p",
                  "attributes": {
                    "title": "[$Betrokkenheid_NL]",
                    "class": "ms-fontColor-neutralPrimary sp-card-content  sp-card-multiline"
                  },

// Verwijder opnieuw het koppelteken tussen de tweede set aanhalingstekens

                  "txtContent": "=if ([$Betrokkenheid_NL] == '', '', [$Betrokkenheid_NL])",

// Verander de waarde (value) van -webkit-line-clamp van 2 naar 8. Dit zijn het aantal regels dat deze toelichting in beslag zal nemen
// Omdat het aantal regels gewijzigd werd moet ook de hoogte van het element aangepast worden (van 40px naar 160px)
// Voeg de twee daaropvolgende lijnen in. Deze zorgen ervoor dat de tekst mooi uitlijnt.

                  "style": {
                    "overflow-y": "auto",
                    "height": "160px",
                    "padding-right": "8px",
                    "-webkit-line-clamp": "8",
                    "word-break": "break-word",
                    "text-align": "justify"
                  }
                }
              ]
            },
            {
              "elmType": "div",
              "attributes": {
                "class": "sp-card-displayColumnContainer"
              },
              "children": [
                {
                  "elmType": "p",
                  "attributes": {
                    "class": "ms-fontColor-neutralSecondary sp-card-label"
                  },
                  "txtContent": "[!Website_NL.DisplayName]",

// Plaats de komma achter de voorgaande lijn en voeg de volgende drie lijnen code in

                  "style": {
                    "display": "none"
                  }
                },
                {
                  "elmType": "a",
                  "attributes": {
                    "title": "[$Website_NL]",
                    "class": "ms-fontColor-neutralPrimary sp-card-content sp-card-urlContent  sp-card-keyboard-focusable",
                    "href": "[$Website_NL]",
                    "target": "=if ([$Website_NL] == '', '', '_blank')"
                  },
                  "style": {
                    "pointer-events": "=if ([$Website_NL] == '', 'none', 'auto')",
                    "text-decoration": "=if ([$Website_NL] == '', 'none', 'auto')",

// Voeg de volgende lijn toe om de link naar de website in het blauw weer te geven. (en vergeet de komma niet! ↑)                    

                    "color": "RGBA(0,0,153)"
                  },

// Vervang de volgende lijn code uit het origineel door het onderstaande

                  "txtContent": "=if ([$Website_NL.desc] == '', '', '🖱   '+[$Website_NL.desc])"
                }
              ]
            },
            {
              "elmType": "div",
              "attributes": {
                "class": "sp-card-lastTextColumnContainer"
              },
              "children": [
                {
                  "elmType": "p",
                  "attributes": {
                    "class": "ms-fontColor-neutralSecondary sp-card-label"
                  },
                  "txtContent": "[!Tel.DisplayName]",

// Plaats de komma achter de voorgaande lijn en voeg de volgende drie lijnen code in

                  "style": {
                    "display": "none"
                  }
                },
                {
                  "elmType": "p",
                  "attributes": {
                    "title": "[$Tel]",
                    "class": "ms-fontColor-neutralPrimary sp-card-content"
                  },

// Vervang de volgende lijn code uit het origineel door het onderstaande

                  "txtContent": "=if ([$Tel] == '', '', '📞  '+[$Tel])"
                }
              ]
            },
            {
              "elmType": "div",
              "attributes": {
                "class": "sp-card-lastTextColumnContainer"
              },
              "children": [
                {
                  "elmType": "p",
                  "attributes": {
                    "class": "ms-fontColor-neutralSecondary sp-card-label"
                  },
                  "txtContent": "[!Email_NL.DisplayName]",

// Plaats de komma achter de voorgaande lijn en voeg de volgende drie lijnen code in
                  
                  "style": {
                    "display": "none"
                  }
                },
                {

// Verander het elmType van p naar a. Het gaat om een functionele link en niet om louter tekst.

                  "elmType": "a",

// Voeg de volgende vier lijnen code in. Deze zorgen ervoor dat het e-mail adres blauw wordt                  

                  "style": {
                    "color": "RGBA(0,0,153)"
                  },
                  "attributes": {
                    "title": "[$Email_NL]",
                    "class": "ms-fontColor-neutralPrimary sp-card-content ",

// Plaats achter de voorgaande lijn een komma en voeg de onderstaande lijn code toe
// Dit zal ervoor zorgen dat voor de bezoeker automatisch een nieuwe mail opent met als geadresseerde het opgegeven adres.

                    "href": "=if ([$Email_NL] == '', '', 'mailto:'+[$Email_NL])"
                  },

// Vervang de volgende lijn code uit het origineel door het onderstaande

                  "txtContent": "=if ([$Email_NL] == '', '', '📧  '+[$Email_NL])"
                }
              ]
            }
          ]
        }
      ]
    }
  }
  